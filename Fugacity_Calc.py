# import preos
# # pass name, Tc [K], Pc [bar], omega
# # https://www.osti.gov/servlets/purl/1145508
# hydrogen = preos.Molecule("hydrogen", 33.145, 12.96, -0.216)
# hydrogen.print_params()
#
# # pass the Molecule, T [K], P [bar] of interest
# props = preos.preos(hydrogen, 62.5+273.15, 125, plotcubic=True, printresults=True)
#
# # https://www.engineeringtoolbox.com/hydrogen-sulfide-H2S-properties-d_2034.html
# # https://www.kaylaiacovino.com/Petrology_Tools/Critical_Constants_and_Acentric_Factors.htm
# hydrogen_sulfide = preos.Molecule("hydrogen sulfide", 373.3, 89.7, 0.081)
# hydrogen_sulfide.print_params()
#
# # https://www.sciencedirect.com/science/article/pii/S0376738815003713?via%3Dihub
# props = preos.preos(hydrogen_sulfide, 62.5+273.15, 125, plotcubic=True, printresults=True)

import preos
import numpy as np

# Initialize the molecule
# pass name, Tc [K], Pc [bar], omega
hydrogen_sulfide = preos.Molecule("hydrogen sulfide", 373.3, 89.7, 0.081)
hydrogen_sulfide.print_params()

# Given temperature values in Celsius
temperatures_C = [
    47.78702, 42.72346, 74.70717, 32.06449, 30.82651, 31.47605, 39.26056, 25.86393, 50.15067,
    62.627, 49.99501, 25.53115, 50.64275, 34.40332, 37.20095, 70.45632, 52.57101, 31.74226,
    73.85869, 67.66952, 42.89688, 69.38689, 72.42069, 48.33943, 67.34052, 51.19357, 48.30866,
    74.24259, 74.51303, 65.25501, 47.82051, 47.01168, 36.76064, 59.43411, 54.49846, 74.32376,
    64.12405, 59.00244, 45.32015, 33.95675, 56.37558, 31.9084, 74.16471, 40.42125, 68.40435,
    46.56255, 45.81246, 25.22122, 39.63432, 54.70878, 54.02078, 63.13207, 63.32976, 59.55137,
    31.95757, 40.75732, 70.3059, 72.78635, 44.29212, 27.47343, 32.14359, 30.86331, 39.56459,
    61.25017, 57.70829, 67.07283, 42.63832, 73.05721, 31.65203, 40.17289, 50.23455, 57.64801,
    74.65177, 71.87641, 51.95389, 64.28131, 73.49394, 66.97323, 69.18827, 51.02215, 55.75369,
    62.48795, 72.08402, 71.10459, 59.84123, 58.76525, 50.93712, 37.25188, 39.3504, 52.7421,
    40.62347, 48.91254, 55.85016, 29.33882, 34.13802, 39.29494, 72.03992, 41.76392, 28.74786,
    53.32586, 34.64119, 44.98117, 72.96583, 49.29094, 34.88894, 39.84353, 27.94756, 32.85616,
    40.46565, 63.45118, 60.14666, 46.93363, 70.21845, 51.16177, 47.39758, 52.25738, 34.80514,
    73.80817, 48.8703, 33.38512, 43.40715, 65.72435, 40.55645, 67.02701, 68.33362, 53.82884,
    74.0366, 39.41858, 74.80747, 30.6914, 27.96774, 55.46433, 36.26068, 26.67736, 45.66885,
    72.82138, 52.00456, 26.36717, 64.91923, 57.71526, 56.79612, 67.55913, 39.23837, 47.33932,
    70.90952, 57.87307, 68.3231, 55.44046, 40.01423, 38.85957, 72.6794, 49.75261, 62.87692,
    34.43125, 51.20859, 52.68493, 62.39243, 44.88918, 44.25311, 44.18869, 69.15289, 46.84444,
    30.2576, 25.6785, 69.05067, 53.49901, 66.29875, 49.33511, 64.50766, 66.50591, 35.16984,
    28.09118, 38.63281, 31.82302, 64.43594, 39.83311, 73.38521, 44.1134, 36.48876, 45.55716,
    55.32483, 35.1433, 27.58783, 53.61767, 36.9446, 61.71809, 73.71427, 29.66809, 40.32836,
    33.27898, 71.951, 70.14549, 37.99292, 29.03294, 54.22117, 33.81933, 41.73603, 47.7105,
    55.24347, 60.69698, 69.28302, 52.05424, 35.81615, 32.58048, 27.82666, 45.42734, 55.74548,
    63.56311, 68.16541, 25.42352, 34.54893, 52.09672, 63.26877, 43.8847, 51.33239, 48.97909,
    45.78788, 37.83664, 48.64785, 46.22166, 63.59286, 36.06263, 69.71389, 34.08768, 62.59325,
    47.62793, 45.10718, 73.97929, 55.13915, 52.45467, 28.24547, 49.08801, 32.34547, 67.42114,
    30.94386, 27.90557, 53.50437, 53.58194, 58.01182, 65.36389, 27.78732, 28.27475, 27.25492,
    63.92289, 29.16815, 50.34452, 72.48963, 37.80622, 29.92992, 56.01579, 66.94198, 35.22365,
    50.09108, 64.3078, 38.08638, 68.0124, 32.03568, 64.68775, 26.26293, 27.40267, 33.10691,
    31.03791, 34.23395, 65.22695, 36.69094, 61.57708, 43.20077, 25.38944, 70.87054, 25.72789,
    66.61455, 46.06633, 30.325, 63.62997, 38.90248, 41.42708, 42.2257, 26.22358, 42.26268,
    73.09848, 67.27877, 71.70312, 43.8248, 44.04034, 49.56299, 64.90852, 47.53408, 49.90287,
    55.18446, 70.11761, 47.86112, 33.02702, 67.91703, 64.81709, 39.52726, 48.79074, 50.69771,
    35.42196, 28.52599, 37.8838, 58.82736, 60.80196, 69.67815, 66.73783, 69.98713, 47.4978,
    68.11288, 41.58494, 56.63548, 57.79592, 31.14589, 46.59697, 74.72403, 67.66658, 70.50154,
    68.80813, 68.07224, 73.45681, 62.8495, 25.11936, 29.55829, 49.49419, 40.09567, 31.6156,
    30.98137, 29.73257, 38.12507, 62.06395, 48.18822, 35.98814, 63.34032, 64.57412, 27.66099,
    41.06024, 39.18911, 56.25038, 66.5565, 51.41726, 62.97227, 43.77692, 25.98283, 39.47429,
    59.41465, 58.55273, 55.04948, 53.26513, 53.76728, 51.40491, 30.56788, 31.67026, 37.43222,
    65.29885, 52.18891, 58.05761, 52.31384, 41.38072, 60.87325, 38.21942, 43.44196, 33.29424,
    60.9895, 58.12576, 26.76913, 45.39165, 58.40267, 46.43938, 31.57176, 47.70809, 66.80753,
    49.18993, 73.15479, 46.18708, 36.1948, 63.19984, 49.6492, 41.68336, 33.66748, 51.62645,
    69.76113, 44.50359, 54.92223, 25.17401, 50.7095, 66.1598, 49.60848, 62.13062, 42.94114,
    45.23558, 26.02175, 60.18672, 39.14063, 48.47833, 30.0183, 66.22473, 25.03135, 40.83527,
    54.415, 51.49336, 73.66648, 47.10766, 42.5323, 45.97293, 37.10715, 46.63322, 63.41558,
    55.03758, 36.65401, 53.7427, 43.95521, 60.34585, 70.93662, 27.21731, 50.96085, 28.56515,
    25.78303, 70.08293, 44.57753, 64.65855, 42.32151, 62.30928, 70.72324, 27.72232, 38.01453,
    73.52006, 39.73589, 72.19052, 36.10778, 31.85141, 72.84212, 50.50479, 40.2536, 74.41446,
    35.63157, 57.22726, 37.55412, 55.97594, 59.92125, 54.96583, 43.10478, 25.29339, 50.01645,
    30.06946, 33.84829, 33.47477, 56.97716, 29.87543, 67.90604, 69.65307, 31.06908, 55.11216,
    64.16397, 60.48648, 41.80607, 54.90554, 40.68568, 30.24524, 48.39238, 70.81445, 51.55439,
    32.80308, 73.94384, 74.3352, 57.39191, 40.24249, 64.73761, 25.34975, 28.87649, 39.92519,
    73.21885, 68.57921, 29.52573, 59.23699, 27.00878, 45.37359, 48.27643, 51.11656, 62.7624,
    46.73514, 67.23429, 40.89234, 63.84375, 30.17843, 34.97868, 71.49723, 60.27805, 41.3328,
    67.51359, 71.58358, 61.08592, 62.73856, 57.77572, 49.66973, 34.70063, 25.80987, 71.73853,
    52.58989, 60.04491, 67.29984, 47.04492, 32.11973, 44.86306, 34.18501, 61.22176, 61.64483,
    66.86728, 33.90661, 26.39528, 53.65856, 59.61306, 35.09901, 32.38553, 59.72195, 39.02553,
    74.16675, 66.40311, 62.53979, 58.88737, 55.69571, 74.25311, 65.53595, 28.76382, 65.61445,
    26.473, 38.19546, 40.95641, 53.87942, 49.04349, 61.75653, 26.81612, 57.97978, 57.54231,
    48.13939, 27.52347, 48.10941, 49.23772, 73.60621, 47.29551, 33.45149, 55.81589, 25.95551,
    56.31524, 39.67276, 47.54513, 69.62045, 57.87699, 33.9947, 60.00759, 29.80178, 50.41811,
    39.78359, 45.05397, 61.03108, 46.00443, 26.99816, 65.40344, 43.58287, 49.12784, 71.16152,
    48.79282, 29.97144, 60.87806, 61.31494, 37.48757, 49.50519, 28.36284, 57.03649, 56.88863,
    73.67478, 70.36744, 57.93637, 72.3632, 70.48822, 41.00439, 67.61832, 38.78641, 45.00621,
    53.97278, 37.71563, 66.87586, 54.6821, 36.59205, 44.34496, 59.49837, 55.39132, 32.88999,
    35.49944, 42.20114, 57.43474, 39.90434, 38.56804, 61.67066, 42.97297, 53.22654, 58.83439,
    29.8342, 56.60878, 63.88512, 41.26786, 44.83222, 27.29384, 44.05713, 73.25545, 41.65807,
    56.8391, 27.3434, 50.25449, 62.92364, 33.37488, 72.65328, 68.22215, 58.92759, 42.02882,
    46.29664, 60.55064, 45.129, 68.65281, 40.14613, 45.94026, 49.39841, 39.11061, 67.46967,
    54.0942, 49.82998, 52.82915, 30.37564, 65.91993, 44.94, 36.14923, 69.43617, 50.04654,
    35.37601, 48.52402, 35.77916, 33.58564, 46.26307, 65.45901, 38.98194, 61.83352, 71.81547,
    51.33511, 67.83854, 37.78911, 42.06234, 44.77371, 65.18124, 39.96466, 38.51967, 72.52207,
    71.86871, 35.37095, 68.17647, 58.35388, 37.05126, 51.83921, 35.91439, 29.28947, 69.53882,
    43.25253, 27.20743, 71.64848, 26.20478, 37.33139, 73.87545, 54.86922, 68.85479, 65.64702,
    39.59954, 32.24075, 56.21445, 42.41791, 28.96641, 62.35114, 61.17742, 69.91542, 26.89433,
    35.61034, 65.76156, 34.54079, 67.16749, 47.94022, 56.95674, 68.60505, 38.9477, 73.1848,
    30.76456, 58.64789, 49.94804, 65.82581, 69.45866, 54.16172, 38.72567, 56.34437, 63.71538,
    31.2891, 69.10336, 64.07013, 26.93217, 34.0771, 46.79103, 71.24067, 65.04257, 68.96231,
    64.03807, 53.08136, 53.38742, 59.50002, 73.56373, 40.74233, 30.1458, 46.99135, 52.627,
    28.65262, 69.35812, 52.90213, 51.50853, 70.40874, 70.97022, 58.21532, 71.50618, 60.77844,
    40.80676, 25.64743, 51.69235, 30.59282, 63.76015, 59.05092, 43.50514, 62.03533, 43.98907,
    64.62205, 38.8138, 71.20006, 59.81883, 72.56368, 62.20804, 28.82253, 58.7192, 25.1368,
    41.56363, 60.63861, 63.23839, 50.29691, 60.95492, 61.0555, 72.05851, 62.6888, 61.96186,
    46.89973, 58.69673, 38.33376, 43.48015, 58.60138, 54.64583, 46.13731, 72.90327, 59.32129,
    64.87316, 74.76418, 71.25204, 66.18223, 32.1678, 39.0715, 37.01652, 71.55104, 73.01509,
    59.7785, 25.88455, 59.14345, 64.98084, 73.33577, 63.0936, 40.07058, 38.48013, 52.83499,
    55.60357, 55.25531, 49.019, 66.33913, 55.50182, 34.46989, 36.01787, 43.07034, 61.51734,
    58.51546, 65.55158, 31.32142, 34.76251, 65.12607, 58.27357, 48.08, 73.33071, 71.39167,
    32.61173, 54.45232, 53.14085, 38.25116, 59.10145, 34.86332, 60.5258, 26.8607, 51.05244,
    44.68069, 71.99644, 35.31265, 52.21805, 58.47596, 56.15253, 44.73306, 25.049, 48.44923,
    26.44167, 42.81206, 61.33601, 71.75813, 34.60541, 59.36441, 45.20196, 57.25965, 40.96748,
    61.14796, 59.66248, 41.97045, 42.47844, 56.10757, 28.84899, 46.47355, 30.44906, 33.14067,
    48.0132, 34.34174, 41.11684, 68.92679, 58.1878, 31.44361, 49.45583, 46.67527, 69.84527,
    46.50047, 58.30326, 32.69733, 64.35998, 45.62603, 54.16853, 68.50986, 53.45778, 27.68275,
    47.27193, 55.33566, 28.40771, 26.15402, 69.5721, 28.31585, 28.04745, 25.25825, 56.55693,
    65.90758, 51.90714, 70.65781, 33.55346, 28.03267, 39.40427, 63.05655, 36.54813, 62.21981,
    63.02606, 36.40762, 68.87728, 48.60028, 47.15483, 29.5964, 42.14043, 41.36662, 62.56304,
    65.01273, 35.57174, 53.95451, 29.13083, 30.52678, 52.47586, 46.36513, 33.78579, 64.16742,
    35.73357, 57.3135, 40.63079, 47.88412, 59.98809, 33.65724, 48.70688, 29.33308, 53.8567,
    64.21058, 30.47516, 54.6031, 66.09389, 38.39244, 26.07458, 56.20108, 29.21686, 65.4376,
    59.19142, 50.46344, 35.92949, 38.08058, 54.35544, 72.41122, 28.46122, 71.35885, 57.61581,
    50.88303, 57.04626, 36.32179, 37.51818, 43.03058, 66.49801, 43.29265, 47.96448, 26.54253,
    51.2846, 43.14125, 41.50232, 67.41171, 41.86811, 29.45116, 67.77315, 58.98217, 33.04666,
    50.78487, 31.24846, 46.82812, 66.43419, 70.18915, 45.50429, 66.76503, 56.73598, 30.65438,
    27.11441, 57.49475, 54.05954, 57.53856, 74.90247, 42.87008, 44.4836, 70.55948, 51.98118,
    61.49584, 62.27882, 40.53625, 49.74437, 68.67686, 57.12209, 65.98699, 29.04246, 63.79388,
    37.59636, 40.33723, 36.90731, 61.39365, 29.78441, 66.68896, 46.40215, 34.71848, 51.60861,
    28.4581, 69.23175, 56.44222, 35.05835, 43.24441, 26.72688, 36.43143, 28.69507, 27.07728,
    52.97153, 57.19483, 48.93736, 53.69003, 61.90478, 60.21002, 74.99643, 38.70637, 37.39507,
    31.50143, 71.32383, 42.60718, 31.08958, 45.6177, 32.71492, 32.64215, 37.21958, 31.36432,
    42.69927, 63.6698, 64.46287, 64.78139, 27.55727, 32.53872, 35.69743, 29.66108, 54.53236,
    58.44636, 68.47166, 36.37118, 52.79105, 70.76478, 62.45562, 51.71955, 74.46821, 74.11336,
    25.56272, 45.48448, 43.66076, 49.29666, 32.42863, 65.68683, 32.76744, 44.23735, 47.60459,
    26.3307, 73.7756, 72.59873, 67.13562, 66.04624, 67.96463, 72.14313, 37.3682, 27.12968,
    38.61333, 56.79006, 67.74049, 52.13675, 70.25383, 37.16594, 32.97387, 56.67131, 55.9318,
    30.12441, 43.5884, 74.05147, 31.41014, 67.81181, 40.38054, 26.64928, 65.85631, 50.59651,
    68.74979, 41.94193, 41.22336, 36.84527, 53.02202, 59.27654, 69.00076, 38.30244, 72.31531,
    33.70852, 26.61672, 58.12093, 43.86849, 32.32489, 33.22603, 52.33728, 51.77422, 70.62073,
    43.34514, 32.91674, 62.82727, 41.90282, 42.38937, 42.11976, 60.72998, 53.12349, 42.33369,
    44.37986, 42.78575, 63.48698, 41.13237, 53.35282, 54.56558, 44.64983, 55.55983, 26.10336,
    52.52037, 37.95353, 72.27024, 54.83208, 67.10454, 27.8506, 34.32206, 47.22833, 38.41995,
    35.28371, 48.57278, 57.36225, 52.39198, 36.82867, 56.07015, 28.93981, 34.28199, 48.71637,
    62.10286, 28.13477, 47.45515, 60.41714, 33.52042, 60.61421, 60.31859, 49.85059, 63.98217,
    29.39312, 71.07255, 33.17656, 45.88131, 50.18135, 57.1651, 71.43795, 36.21571, 71.00394,
    61.5926, 47.19869, 35.02893, 55.88072, 69.92336, 63.53059, 51.83056, 45.86939, 66.0346,
    44.44965, 27.4213, 60.38035, 34.91882, 28.20145, 56.49323, 61.9371, 66.26185, 68.75582,
    54.75631, 32.49757, 36.53775, 50.54314, 72.93296, 68.4521, 55.64194, 25.48041, 31.76044,
    41.17787, 65.08359, 74.45215, 30.37153, 35.86406, 50.40439, 50.84123, 59.68442, 36.72129,
    41.47836, 60.12061, 30.72008, 42.55397, 53.20128, 31.99418, 74.54172, 68.27801, 30.90436,
    69.3082, 61.82492, 34.03875, 54.28471, 29.08372, 59.87853, 72.24942, 32.26433, 45.2694,
    50.81273, 54.32873, 52.92863, 44.59632, 28.60503, 37.66266, 70.03579, 66.66389, 45.74232,
    36.9828, 72.74051, 46.10174, 37.67689, 48.23545, 43.67422, 56.53679, 61.42728, 26.50311,
    35.50124, 44.14361, 31.20356, 25.59398, 70.68587, 64.38292, 69.81085, 74.60093, 29.48885,
    43.7137
]

# Convert temperature from Celsius to Kelvin
temperatures_K = [temp + 273.15 for temp in temperatures_C]

# Pressure fixed at 130 bar
pressure = 130

# Calculate fugacity coefficients for each temperature
fugacity_coefficients = []

for temp in temperatures_K:
    props = preos.preos(hydrogen_sulfide, temp, pressure, plotcubic=False, printresults=False)
    # print(props)
    fugacity_coefficients.append(props['fugacity_coefficient'])

# Convert the list to a numpy array
fugacity_coefficients_array = np.array(fugacity_coefficients)

# Save the array to a text file
np.savetxt('./fug.txt', fugacity_coefficients_array, fmt='%.6f')

# # Print the fugacity coefficients
# for temp, fugacity in zip(temperatures_C, fugacity_coefficients):
#     print(f"Temperature (C): {temp}, Fugacity Coefficient: {fugacity:.6f}")
